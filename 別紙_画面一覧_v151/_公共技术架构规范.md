# åˆ¥ç´™_ç”»é¢ä¸€è¦§_v151 - å…¬å…±æŠ€æœ¯æ¶æ„è§„èŒƒ

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|------|------|
| **æ–‡æ¡£åç§°** | å…¬å…±æŠ€æœ¯æ¶æ„è§„èŒƒ |
| **æ–‡æ¡£ç‰ˆæœ¬** | v1.0 |
| **åˆ›å»ºæ—¥æœŸ** | 2026-02-XX|
| **é€‚ç”¨èŒƒå›´** | æ‰€æœ‰å·¥ä½œè¡¨ |
| **çŠ¶æ€** | âœ… å·²å‘å¸ƒ |

---

## 1. æŠ€æœ¯æ¶æ„æ€»è§ˆ

### 1.1 æ•´ä½“æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯å±‚ (React)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   React 18   â”‚  â”‚  TypeScript â”‚  â”‚ Ant Design  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚React Router â”‚  â”‚   Zustand   â”‚  â”‚   Axios     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTPS (REST API)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åç«¯å±‚ (Spring Boot)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Spring Boot â”‚  â”‚  Java 17    â”‚  â”‚Spring Sec   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚Spring Data â”‚  â”‚ PostgreSQL  â”‚  â”‚    Redis    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ•°æ®å±‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚    PostgreSQL 15.x       â”‚  â”‚    Redis 7.x       â”‚   â”‚
â”‚  â”‚    (ä¸»æ•°æ®åº“)            â”‚  â”‚    (ç¼“å­˜)           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æŠ€æœ¯æ ˆçŸ©é˜µ

| å±‚çº§ | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|------|
| **å‰ç«¯** | React | 18.x | UIæ¡†æ¶ |
| **å‰ç«¯** | TypeScript | 5.x | ç±»å‹å®‰å…¨ |
| **å‰ç«¯** | React Router | 6.x | è·¯ç”±ç®¡ç† |
| **å‰ç«¯** | Zustand | 4.x | çŠ¶æ€ç®¡ç† |
| **å‰ç«¯** | Axios | 1.x | HTTPå®¢æˆ·ç«¯ |
| **å‰ç«¯** | Ant Design | 5.x | UIç»„ä»¶åº“ |
| **å‰ç«¯** | Framer Motion | 10.x | åŠ¨ç”»æ•ˆæœ |
| **åç«¯** | Spring Boot | 3.2.x | åº”ç”¨æ¡†æ¶ |
| **åç«¯** | Java | 17 | å¼€å‘è¯­è¨€ |
| **åç«¯** | Spring Security | 6.x | å®‰å…¨æ¡†æ¶ |
| **åç«¯** | Spring Data JPA | 3.x | æ•°æ®è®¿é—® |
| **æ•°æ®åº“** | PostgreSQL | 15.x | å…³ç³»å‹æ•°æ®åº“ |
| **ç¼“å­˜** | Redis | 7.x | ç¼“å­˜æœåŠ¡å™¨ |
| **è®¤è¯** | OAuth 2.0 + JWT | - | Tokenè®¤è¯ |
| **éƒ¨ç½²** | Docker + K8s | - | å®¹å™¨åŒ–éƒ¨ç½² |

---

## 2. å‰ç«¯æ¶æ„è§„èŒƒ

### 2.1 å‰ç«¯é¡¹ç›®ç»“æ„
```
frontend/ (Reacté¡¹ç›®)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/           # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Layout/          # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ MainLayout.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ SideMenu.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Breadcrumb.tsx
â”‚   â”‚   â”œâ”€â”€ Navigation/       # å¯¼èˆªç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Menu.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ TabNav.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Breadcrumb.tsx
â”‚   â”‚   â””â”€â”€ Common/          # é€šç”¨ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ Button.tsx
â”‚   â”‚       â”œâ”€â”€ Modal.tsx
â”‚   â”‚       â””â”€â”€ Table.tsx
â”‚   â”œâ”€â”€ pages/               # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ b0/             # åŸºç¡€ç”¨æˆ·é¡µé¢
â”‚   â”‚   â”œâ”€â”€ b1/
â”‚   â”‚   â”œâ”€â”€ ...
â”‚   â”‚   â””â”€â”€ p0/             # è¿è¾“åˆä½œä¼™ä¼´é¡µé¢
â”‚   â”œâ”€â”€ hooks/               # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â”œâ”€â”€ usePermission.ts
â”‚   â”‚   â””â”€â”€ useNavigation.ts
â”‚   â”œâ”€â”€ stores/              # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ authStore.ts
â”‚   â”‚   â”œâ”€â”€ permissionStore.ts
â”‚   â”‚   â””â”€â”€ navigationStore.ts
â”‚   â”œâ”€â”€ services/            # APIæœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ authService.ts
â”‚   â”‚   â”œâ”€â”€ screenService.ts
â”‚   â”‚   â””â”€â”€ permissionService.ts
â”‚   â”œâ”€â”€ types/               # TypeScriptç±»å‹
â”‚   â”‚   â”œâ”€â”€ api.type.ts
â”‚   â”‚   â”œâ”€â”€ screen.type.ts
â”‚   â”‚   â””â”€â”€ permission.type.ts
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ apiUtils.ts
â”‚   â”‚   â””â”€â”€ permissionUtils.ts
â”‚   â”œâ”€â”€ router/              # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â””â”€â”€ routes.tsx
â”‚   â”œâ”€â”€ assets/              # é™æ€èµ„æº
â”‚   â”œâ”€â”€ styles/              # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ App.tsx              # åº”ç”¨å…¥å£
â”œâ”€â”€ public/                  # publicç›®å½•
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ vite.config.ts           # Viteé…ç½®
```

### 2.2 å‰ç«¯ç±»å‹å®šä¹‰æ ‡å‡†
```typescript
// src/types/api.type.ts

// APIå“åº”åŸºç¡€ç±»å‹
export interface ApiResponse<T> {
  code: number;
  message: string;
  data: T;
}

// åˆ†é¡µç±»å‹
export interface PageResult<T> {
  total: number;
  page: number;
  pageSize: number;
  list: T[];
}

// ç”¨æˆ·ç±»å‹
export interface User {
  userId: string;
  userName: string;
  roleId: string;
  roleName: string;
  email?: string;
  phone?: string;
  createdAt: string;
  updatedAt: string;
}

// è§’è‰²ç±»å‹
export interface Role {
  roleId: string;
  roleName: string;
  roleNameZh: string;
  description: string;
  isActive: boolean;
}

// æƒé™çº§åˆ«
export type AccessLevel = 2 | 1 | 0 | -1;

// æƒé™é…ç½®
export interface Permission {
  screenId: string;
  accessLevel: AccessLevel;
  canRead: boolean;
  canWrite: boolean;
  canDelete: boolean;
}

// ç”¨æˆ·æƒé™
export interface UserPermission {
  userId: string;
  roleId: string;
  permissions: Permission[];
}

// ç•Œé¢ç±»å‹
export interface Screen {
  screenId: string;
  screenName: string;
  category: string;
  description: string;
  routePath: string;
  componentName: string;
  devicePc: boolean;
  deviceSp: boolean;
  sortOrder: number;
  isActive: boolean;
}
```

### 2.3 å‰ç«¯æƒé™Hookæ ‡å‡†
```typescript
// src/hooks/usePermission.ts

import { useCallback } from 'react';
import { useAuthStore } from '@/stores/authStore';
import { permissionService } from '@/services/permissionService';
import type { AccessLevel, Permission } from '@/types/permission.type';

interface PermissionResult {
  canRead: boolean;
  canWrite: boolean;
  canDelete: boolean;
  accessLevel: AccessLevel;
  hasAccess: boolean;
}

export const usePermission = (screenId: string): PermissionResult => {
  const { user } = useAuthStore();
  
  const checkPermission = useCallback((): PermissionResult => {
    if (!user) {
      return {
        canRead: false,
        canWrite: false,
        canDelete: false,
        accessLevel: 0,
        hasAccess: false,
      };
    }
    
    return permissionService.checkPermission(user.roleId, screenId);
  }, [user, screenId]);
  
  return checkPermission();
};

// æƒé™é«˜é˜¶ç»„ä»¶
export const withPermission = (
  WrappedComponent: React.ComponentType<any>,
  screenId: string,
  minimumLevel: AccessLevel = 1
) => {
  return (props: any) => {
    const { hasAccess, accessLevel } = usePermission(screenId);
    
    if (!hasAccess || accessLevel < minimumLevel) {
      return null; // æˆ–æ˜¾ç¤º403é¡µé¢
    }
    
    return <WrappedComponent {...props} />;
  };
};
```

### 2.4 å‰ç«¯è·¯ç”±å®ˆå«
```typescript
// src/router/guards/authGuard.tsx

import { Navigate } from 'react-router-dom';
import { Spin } from 'antd';
import { useAuthStore } from '@/stores/authStore';

interface AuthGuardProps {
  children: React.ReactNode;
  requiredRole?: string[];
}

export const AuthGuard: React.FC<AuthGuardProps> = ({ 
  children, 
  requiredRole 
}) => {
  const { isAuthenticated, user, loading } = useAuthStore();
  
  if (loading) {
    return <Spin tip="è®¤è¯ä¸­..." fullscreen />;
  }
  
  if (!isAuthenticated) {
    return <Navigate to="/login" replace />;
  }
  
  // è§’è‰²æ£€æŸ¥
  if (requiredRole && user && !requiredRole.includes(user.roleId)) {
    return <Navigate to="/403" replace />;
  }
  
  return <>{children}</>;
};

// æƒé™è·¯ç”±å®ˆå«
export const PermissionGuard: React.FC<{
  screenId: string;
  minimumLevel?: 1 | 2;
  children: React.ReactNode;
}> = ({ screenId, minimumLevel = 1, children }) => {
  const { hasAccess, accessLevel } = usePermission(screenId);
  
  if (!hasAccess || accessLevel < minimumLevel) {
    return <Navigate to="/403" replace />;
  }
  
  return <>{children}</>;
};
```

### 2.5 å‰ç«¯APIæœåŠ¡æ ‡å‡†
```typescript
// src/services/api.ts

import axios, { AxiosInstance, AxiosRequestConfig } from 'axios';
import { message } from 'antd';

// åˆ›å»ºAxioså®ä¾‹
const apiClient: AxiosInstance = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
  timeout: 30000,
  headers: {
    'Content-Type': 'application/json',
  },
});

// è¯·æ±‚æ‹¦æˆªå™¨
apiClient.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// å“åº”æ‹¦æˆªå™¨
apiClient.interceptors.response.use(
  (response) => {
    const { code, message: msg, data } = response.data;
    
    if (code === 200) {
      return data;
    }
    
    message.error(msg || 'è¯·æ±‚å¤±è´¥');
    return Promise.reject(new Error(msg));
  },
  (error) => {
    if (error.response) {
      const { status, data } = error.response;
      
      switch (status) {
        case 401:
          message.error('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•');
          // è·³è½¬åˆ°ç™»å½•é¡µ
          window.location.href = '/login';
          break;
        case 403:
          message.error('æ²¡æœ‰æƒé™è®¿é—®');
          break;
        case 404:
          message.error('è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨');
          break;
        case 500:
          message.error('æœåŠ¡å™¨é”™è¯¯');
          break;
        default:
          message.error(data?.message || 'è¯·æ±‚å¤±è´¥');
      }
    }
    return Promise.reject(error);
  }
);

export default apiClient;

// APIæœåŠ¡ç±»æ¨¡æ¿
export class ApiService<T> {
  private endpoint: string;
  
  constructor(endpoint: string) {
    this.endpoint = endpoint;
  }
  
  getAll(): Promise<T[]> {
    return apiClient.get(`/${this.endpoint}`);
  }
  
  getById(id: string): Promise<T> {
    return apiClient.get(`/${this.endpoint}/${id}`);
  }
  
  create(data: Partial<T>): Promise<T> {
    return apiClient.post(`/${this.endpoint}`, data);
  }
  
  update(id: string, data: Partial<T>): Promise<T> {
    return apiClient.put(`/${this.endpoint}/${id}`, data);
  }
  
  delete(id: string): Promise<void> {
    return apiClient.delete(`/${this.endpoint}/${id}`);
  }
}
```

---

## 3. åç«¯æ¶æ„è§„èŒƒ

### 3.1 åç«¯é¡¹ç›®ç»“æ„
```
backend/ (Spring Booté¡¹ç›®)
â”œâ”€â”€ src/main/java/com/yamato/base/
â”‚   â”œâ”€â”€ BaseApplication.java         # å¯åŠ¨ç±»
â”‚   â”œâ”€â”€ config/                      # é…ç½®ç±»
â”‚   â”‚   â”œâ”€â”€ SecurityConfig.java      # Spring Securityé…ç½®
â”‚   â”‚   â”œâ”€â”€ CorsConfig.java         # è·¨åŸŸé…ç½®
â”‚   â”‚   â”œâ”€â”€ RedisConfig.java         # Redisé…ç½®
â”‚   â”‚   â”œâ”€â”€ SwaggerConfig.java       # APIæ–‡æ¡£é…ç½®
â”‚   â”‚   â””â”€â”€ AsyncConfig.java         # å¼‚æ­¥é…ç½®
â”‚   â”œâ”€â”€ common/                      # å…¬å…±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ constant/                # å¸¸é‡ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ PermissionConstant.java
â”‚   â”‚   â”‚   â””â”€â”€ ScreenConstant.java
â”‚   â”‚   â”œâ”€â”€ result/                  # è¿”å›ç»“æœ
â”‚   â”‚   â”‚   â”œâ”€â”€ Result.java
â”‚   â”‚   â”‚   â””â”€â”€ ResultCode.java
â”‚   â”‚   â”œâ”€â”€ exception/               # å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ BusinessException.java
â”‚   â”‚   â”‚   â””â”€â”€ GlobalExceptionHandler.java
â”‚   â”‚   â”œâ”€â”€ utils/                   # å·¥å…·ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ JwtTokenProvider.java
â”‚   â”‚   â”‚   â””â”€â”€ DateUtils.java
â”‚   â”‚   â””â”€â”€ annotation/              # è‡ªå®šä¹‰æ³¨è§£
â”‚   â”‚       â””â”€â”€ RequirePermission.java
â”‚   â”œâ”€â”€ security/                   # å®‰å…¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ JwtTokenProvider.java   # JWTå·¥å…·
â”‚   â”‚   â”œâ”€â”€ JwtAuthenticationFilter.java # JWTè¿‡æ»¤å™¨
â”‚   â”‚   â”œâ”€â”€ UserDetailsServiceImpl.java
â”‚   â”‚   â””â”€â”€ AuthenticationEntryPointImpl.java
â”‚   â””â”€â”€ modules/                     # ä¸šåŠ¡æ¨¡å—
â”‚       â”œâ”€â”€ screen/                 # ç”»é¢æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ controller/
â”‚       â”‚   â”‚   â””â”€â”€ ScreenController.java
â”‚       â”‚   â”œâ”€â”€ service/
â”‚       â”‚   â”‚   â”œâ”€â”€ ScreenService.java
â”‚       â”‚   â”‚   â””â”€â”€ ScreenServiceImpl.java
â”‚       â”‚   â”œâ”€â”€ repository/
â”‚       â”‚   â”‚   â””â”€â”€ ScreenRepository.java
â”‚       â”‚   â”œâ”€â”€ entity/
â”‚       â”‚   â”‚   â””â”€â”€ Screen.java
â”‚       â”‚   â””â”€â”€ dto/
â”‚       â”‚       â”œâ”€â”€ ScreenDTO.java
â”‚       â”‚       â””â”€â”€ ScreenQueryDTO.java
â”‚       â”œâ”€â”€ permission/              # æƒé™æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ controller/
â”‚       â”‚   â”œâ”€â”€ service/
â”‚       â”‚   â”œâ”€â”€ repository/
â”‚       â”‚   â”œâ”€â”€ entity/
â”‚       â”‚   â””â”€â”€ dto/
â”‚       â””â”€â”€ user/                   # ç”¨æˆ·æ¨¡å—
â”‚           â”œâ”€â”€ controller/
â”‚           â”œâ”€â”€ service/
â”‚           â”œâ”€â”€ repository/
â”‚           â”œâ”€â”€ entity/
â”‚           â””â”€â”€ dto/
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ application.yml              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ application-dev.yml         # å¼€å‘ç¯å¢ƒ
â”‚   â”œâ”€â”€ application-prod.yml        # ç”Ÿäº§ç¯å¢ƒ
â”‚   â”œâ”€â”€ db/migration/               # Flywayè„šæœ¬
â”‚   â””â”€â”€ static/                     # é™æ€èµ„æº
â””â”€â”€ pom.xml                         # Mavené…ç½®
```

### 3.2 åç«¯å®ä½“ç±»æ ‡å‡†
```java
// src/main/java/com/yamato/base/common/entity/BaseEntity.java

package com.yamato.base.common.entity;

import jakarta.persistence.*;
import lombok.*;
import java.time.LocalDateTime;

@MappedSuperclass
@Data
@NoArgsConstructor
@AllArgsConstructor
public abstract class BaseEntity {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(name = "is_active")
    @Builder.Default
    private Boolean isActive = true;
    
    @Column(name = "created_at")
    private LocalDateTime createdAt;
    
    @Column(name = "created_by", length = 50)
    private String createdBy;
    
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;
    
    @Column(name = "updated_by", length = 50)
    private String updatedBy;
    
    @PrePersist
    protected void onCreate() {
        createdAt = LocalDateTime.now();
        if (isActive == null) {
            isActive = true;
        }
    }
    
    @PreUpdate
    protected void onUpdate() {
        updatedAt = LocalDateTime.now();
    }
}
```

```java
// src/main/java/com/yamato/base/modules/screen/entity/Screen.java

package com.yamato.base.modules.screen.entity;

import com.yamato.base.common.entity.BaseEntity;
import jakarta.persistence.*;
import lombok.*;

@Entity
@Table(name = "m_screen")
@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class Screen extends BaseEntity {
    
    @Column(name = "screen_id", nullable = false, unique = true, length = 20)
    private String screenId;
    
    @Column(name = "screen_name", nullable = false, length = 100)
    private String screenName;
    
    @Column(name = "category", length = 50)
    private String category;
    
    @Column(name = "description", columnDefinition = "TEXT")
    private String description;
    
    @Column(name = "route_path", length = 100)
    private String routePath;
    
    @Column(name = "component_name", length = 100)
    private String componentName;
    
    @Column(name = "device_pc")
    @Builder.Default
    private Boolean devicePc = false;
    
    @Column(name = "device_sp")
    @Builder.Default
    private Boolean deviceSp = false;
    
    @Column(name = "sort_order")
    @Builder.Default
    private Integer sortOrder = 0;
}
```

### 3.3 åç«¯Repositoryæ ‡å‡†
```java
// src/main/java/com/yamato/base/modules/screen/repository/ScreenRepository.java

package com.yamato.base.modules.screen.repository;

import com.yamato.base.modules.screen.entity.Screen;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.stereotype.Repository;

import java.util.List;
import java.util.Optional;

@Repository
public interface ScreenRepository extends JpaRepository<Screen, Long> {
    
    Optional<Screen> findByScreenId(String screenId);
    
    List<Screen> findByIsActiveTrueOrderBySortOrderAsc();
    
    List<Screen> findByCategoryAndIsActiveTrueOrderBySortOrderAsc(String category);
    
    @Query("SELECT s FROM Screen s WHERE s.screenId IN :screenIds AND s.isActive = true")
    List<Screen> findByScreenIdIn(@Param("screenIds") List<String> screenIds);
    
    boolean existsByScreenId(String screenId);
}
```

### 3.4 åç«¯Serviceæ ‡å‡†
```java
// src/main/java/com/yamato/base/modules/screen/service/ScreenService.java

package com.yamato.base.modules.screen.service;

import com.yamato.base.common.result.Result;
import com.yamato.base.modules.screen.dto.*;
import java.util.List;

public interface ScreenService {
    
    Result<List<ScreenDTO>> getAllScreens();
    
    Result<ScreenDTO> getScreenById(String screenId);
    
    Result<List<ScreenDTO>> getScreensByCategory(String category);
    
    Result<List<ScreenDTO>> getScreensByIds(List<String> screenIds);
    
    Result<ScreenDTO> createScreen(CreateScreenDTO dto);
    
    Result<ScreenDTO> updateScreen(String screenId, UpdateScreenDTO dto);
    
    Result<Void> deleteScreen(String screenId);
    
    Result<List<ScreenDTO>> getAccessibleScreens(String userId);
}
```

### 3.5 åç«¯Controlleræ ‡å‡†
```java
// src/main/java/com/yamato/base/modules/screen/controller/ScreenController.java

package com.yamato.base.modules.screen.controller;

import com.yamato.base.common.result.Result;
import com.yamato.base.modules.screen.dto.*;
import com.yamato.base.modules.screen.service.ScreenService;
import lombok.RequiredArgsConstructor;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/v1/screens")
@RequiredArgsConstructor
public class ScreenController {
    
    private final ScreenService screenService;
    
    @GetMapping
    public Result<List<ScreenDTO>> getAllScreens() {
        return screenService.getAllScreens();
    }
    
    @GetMapping("/{screenId}")
    public Result<ScreenDTO> getScreenById(@PathVariable String screenId) {
        return screenService.getScreenById(screenId);
    }
    
    @GetMapping("/accessible")
    public Result<List<ScreenDTO>> getAccessibleScreens() {
        return screenService.getAccessibleScreens(/* current user id */);
    }
    
    @PostMapping
    @PreAuthorize("hasRole('ADMIN')")
    public Result<ScreenDTO> createScreen(@RequestBody CreateScreenDTO dto) {
        return screenService.createScreen(dto);
    }
    
    @PutMapping("/{screenId}")
    @PreAuthorize("hasRole('ADMIN')")
    public Result<ScreenDTO> updateScreen(
            @PathVariable String screenId,
            @RequestBody UpdateScreenDTO dto) {
        return screenService.updateScreen(screenId, dto);
    }
    
    @DeleteMapping("/{screenId}")
    @PreAuthorize("hasRole('ADMIN')")
    public Result<Void> deleteScreen(@PathVariable String screenId) {
        return screenService.deleteScreen(screenId);
    }
}
```

---

## 4. APIæ¥å£è§„èŒƒ

### 4.1 APIå“åº”æ ‡å‡†æ ¼å¼
```json
{
  "code": 200,
  "message": "success",
  "data": {
    // ä¸šåŠ¡æ•°æ®
  },
  "timestamp": "2024-01-15T10:30:00",
  "traceId": "abc123"
}
```

### 4.2 APIé”™è¯¯ç æ ‡å‡†
| é”™è¯¯ç  | è¯´æ˜ |
|--------|------|
| 200 | æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªè®¤è¯ |
| 403 | æ— æƒé™ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨é”™è¯¯ |

### 4.3 APIç‰ˆæœ¬æ§åˆ¶
```
/api/v1/screens    # v1ç‰ˆæœ¬
/api/v2/screens   # v2ç‰ˆæœ¬ï¼ˆæœªæ¥ï¼‰
```

### 4.4 åˆ†é¡µAPIæ ‡å‡†
```yaml
GET /api/v1/screens?page=1&pageSize=20&category=è®¢å•ç®¡ç†

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 100,
    "page": 1,
    "pageSize": 20,
    "totalPages": 5,
    "list": [
      {
        "screenId": "b2",
        "screenName": "ç™ºæ³¨æ¤œç´¢"
      }
    ]
  }
}
```

---

## 5. æ•°æ®åº“è®¾è®¡è§„èŒƒ

### 5.1 å‘½åè§„èŒƒ
| ç±»å‹ | è§„åˆ™ | ç¤ºä¾‹ |
|------|------|------|
| è¡¨å | m_æ¨¡å—å | m_screen, m_permission |
| åˆ—å | snake_case | screen_id, created_at |
| ä¸»é”® | id | id |
| å¤–é”® | å®ä½“å_id | screen_id, user_id |
| ç´¢å¼• | idx_è¡¨å_åˆ—å | idx_screen_category |

### 5.2 å…¬å…±è¡¨ç»“æ„

#### m_screen (ç”»é¢è¡¨)
```sql
CREATE TABLE m_screen (
    id BIGSERIAL PRIMARY KEY,
    screen_id VARCHAR(20) NOT NULL UNIQUE,
    screen_name VARCHAR(100) NOT NULL,
    category VARCHAR(50),
    description TEXT,
    route_path VARCHAR(100),
    component_name VARCHAR(100),
    device_pc BOOLEAN DEFAULT FALSE,
    device_sp BOOLEAN DEFAULT FALSE,
    sort_order INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by VARCHAR(50),
    updated_at TIMESTAMP,
    updated_by VARCHAR(50),
    
    CONSTRAINT uk_screen_id UNIQUE (screen_id)
);

CREATE INDEX idx_screen_category ON m_screen(category);
CREATE INDEX idx_screen_route ON m_screen(route_path);
```

#### m_permission (æƒé™è¡¨)
```sql
CREATE TABLE m_permission (
    id BIGSERIAL PRIMARY KEY,
    role_id VARCHAR(20) NOT NULL,
    screen_id VARCHAR(20) NOT NULL,
    access_level INTEGER NOT NULL CHECK (access_level IN (0, 1, 2)),
    can_read BOOLEAN DEFAULT FALSE,
    can_write BOOLEAN DEFAULT FALSE,
    can_delete BOOLEAN DEFAULT FALSE,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    CONSTRAINT uk_role_screen UNIQUE (role_id, screen_id)
);

CREATE INDEX idx_permission_role ON m_permission(role_id);
CREATE INDEX idx_permission_screen ON m_permission(screen_id);
```

#### m_role (è§’è‰²è¡¨)
```sql
CREATE TABLE m_role (
    id BIGSERIAL PRIMARY KEY,
    role_id VARCHAR(20) NOT NULL UNIQUE,
    role_name VARCHAR(50) NOT NULL,
    role_name_zh VARCHAR(50) NOT NULL,
    description VARCHAR(200),
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 6. å®‰å…¨è§„èŒƒ

### 6.1 JWTé…ç½®
```yaml
# application.yml
jwt:
  secret: ${JWT_SECRET:your-256-bit-secret-key}
  expiration: 86400000  # 24å°æ—¶
  refresh-expiration: 604800000  # 7å¤©
```

### 6.2 Spring Securityé…ç½®
```java
@Configuration
@EnableWebSecurity
@RequiredArgsConstructor
public class SecurityConfig {
    
    private final JwtAuthenticationFilter jwtAuthFilter;
    private final AuthenticationProvider authenticationProvider;
    
    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
            .csrf(csrf -> csrf.disable())
            .cors(cors -> cors.configurationSource(corsConfigurationSource()))
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/api/v1/auth/**").permitAll()
                .requestMatchers("/swagger-ui/**").permitAll()
                .requestMatchers("/actuator/health").permitAll()
                .anyRequest().authenticated()
            )
            .sessionManagement(session -> session
                .sessionCreationPolicy(SessionCreationPolicy.STATELESS)
            )
            .authenticationProvider(authenticationProvider)
            .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class);
        
        return http.build();
    }
}
```

---

## 7. éƒ¨ç½²æ¶æ„

### 7.1 Dockeré…ç½®
```yaml
# docker-compose.yml
version: '3.8'

services:
  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    environment:
      - VITE_API_BASE_URL=http://backend:8080
    depends_on:
      - backend

  backend:
    build: ./backend
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - DB_HOST=postgres
      - REDIS_HOST=redis
    depends_on:
      - postgres
      - redis

  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: yamato_base
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./db/migration:/docker-entrypoint-initdb.d

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

volumes:
  postgres_data:
```

---

## 8. éªŒæ”¶æ ‡å‡†

### 8.1 å‰ç«¯éªŒæ”¶æ ‡å‡†
| é¡¹ç›® | æ ‡å‡† | å·¥å…· |
|------|------|------|
| TypeScriptç¼–è¯‘ | æ— é”™è¯¯ | tsc |
| ESLint | æ— è­¦å‘Š | eslint |
| å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | >80% | Jest |
| é¦–å±åŠ è½½ | <2ç§’ | Lighthouse |
| æ„å»ºå¤§å° | <500KB gzipped | bundle analyzer |

### 8.2 åç«¯éªŒæ”¶æ ‡å‡†
| é¡¹ç›® | æ ‡å‡† | å·¥å…· |
|------|------|------|
| å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | >80% | JUnit 5 |
| APIå“åº”æ—¶é—´ | <200ms | JMeter |
| å¹¶å‘ç”¨æˆ· | >1000 | JMeter |
| ä»£ç è§„èŒƒ | æ— è­¦å‘Š | SonarQube |

### 8.3 å®‰å…¨éªŒæ”¶æ ‡å‡†
| é¡¹ç›® | æ ‡å‡† |
|------|------|
| SQLæ³¨å…¥ | é˜²æŠ¤ç”Ÿæ•ˆ |
| XSSæ”»å‡» | é˜²æŠ¤ç”Ÿæ•ˆ |
| CSRFæ”»å‡» | é˜²æŠ¤ç”Ÿæ•ˆ |
| JWTè¿‡æœŸ | æ­£å¸¸ç”Ÿæ•ˆ |
| æ•æ„Ÿæ—¥å¿— | ä¸è®°å½• |

---

## 9. ç›¸å…³æ–‡æ¡£

### 9.1 é¡¹ç›®æ–‡æ¡£ç»“æ„
```
åˆ¥ç´™_ç”»é¢ä¸€è¦§_v151/
â”œâ”€â”€ _å…¬å…±æŠ€æœ¯æ¶æ„è§„èŒƒ.md        â† æœ¬æ–‡æ¡£
â”œâ”€â”€ _æ–‡æ¡£æ ‡å‡†åŒ–è§„èŒƒ.md
â”œâ”€â”€ ç”»é¢ä¸€è¦§/
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ 01_åŸºç¡€ä¿¡æ¯.md
â”‚   â”œâ”€â”€ 02_è¯¦ç»†åˆ†æ.md
â”‚   â”œâ”€â”€ 03_ç»Ÿè®¡åˆ†æ.md
â”‚   â””â”€â”€ 05_è®¾è®¡è§„èŒƒ.md        â† å¼•ç”¨æœ¬è§„èŒƒ
â”œâ”€â”€ ç”»é¢é·ç§»å›³/
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ 01_åŸºç¡€ä¿¡æ¯.md
â”‚   â”œâ”€â”€ 03_ç»Ÿè®¡åˆ†æ.md
â”‚   â”œâ”€â”€ 04_å¯¼èˆªæµç¨‹è¯´æ˜.md
â”‚   â””â”€â”€ 05_è®¾è®¡è§„èŒƒ.md        â† å¼•ç”¨æœ¬è§„èŒƒ
â””â”€â”€ b0-å…±é€šãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³/
    â”œâ”€â”€ README.md
    â”œâ”€â”€ 02_è¯¦ç»†åˆ†æ.md
    â”œâ”€â”€ 03_ç»Ÿè®¡åˆ†æ.md
    â””â”€â”€ 05_è®¾è®¡è§„èŒƒ.md        â† å¼•ç”¨æœ¬è§„èŒƒ
```

---

**æ–‡æ¡£ç¼–åˆ¶**: -  
**ç¼–åˆ¶æ—¶é—´**: 2026-02-XX 
**é€‚ç”¨èŒƒå›´**: åˆ¥ç´™_ç”»é¢ä¸€è¦§_v151 æ‰€æœ‰å·¥ä½œè¡¨  
**çŠ¶æ€**: âœ… å·²å‘å¸ƒ