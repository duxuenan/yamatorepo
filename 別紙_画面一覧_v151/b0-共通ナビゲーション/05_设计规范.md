# b0-共通ナビゲーション - 设计规范

## 1. 功能概述

### 1.1 文档信息
| 项目 | 内容 |
|------|------|
| **工作表名称** | b0-共通ナビゲーション |
| **界面编号** | b0 |
| **文档版本** | v1.0 |
| **最后更新** | 2026-02-XX|
| **文档状态** | ✅ 已发布 |

### 1.2 功能描述
b0-共通ナビゲーション 是基础用户的通用导航菜单组件，为所有功能界面提供统一的导航入口。

### 1.3 技术架构
本文档基于 **前后端分离架构**，详细技术规范请参考：

👉 **[\_公共技术架构规范.md](../_公共技术架构规范.md)**

| 层级 | 技术 |
|------|------|
| 前端 | React 18.x + TypeScript + Ant Design |
| 后端 | Spring Boot 3.x + Java 17 |
| 状态管理 | Zustand |
| 路由管理 | React Router 6.x |

### 1.4 核心功能
- 提供系统主要功能的快速访问入口
- 显示当前用户权限范围内的菜单项
- 支持PC端固定位置常时显示
- 动态渲染权限内可见菜单项

### 1.5 适用范围
- 前端开发人员（React导航组件实现）
- 后端开发人员（Spring Boot API开发）
- UI/UX设计师（菜单样式设计）
- 测试工程师（导航功能测试）

---

## 2. 菜单项清单

### 2.1 菜单结构

| 序号 | 菜单名称 | 目标界面 | 功能分类 | 权限级别 |
|------|----------|----------|----------|----------|
| ⑴ | 発注管理 | b2-発注検索 | 订单管理 | ○/△ |
| ⑵ | 実績管理 | b4-実績検索 | 业绩管理 | ○/△ |
| ⑶ | 被請求管理 | b6-被請求管理 | 计费管理 | ○/△ |
| ⑷ | CSVアップロード | b8-CSVアップロード | 数据管理 | ○/△ |
| ⑸ | アクション履歴 | b9-アクション履歴 | 审计追踪 | △ |
| ⑹ | マスタ管理 | b10-マスタ管理 | 系统管理 | ○/△ |
| ⑺ | ログアウト | b1-スタート | 系统功能 | - |

### 2.2 菜单详细说明

#### ⑴ 発注管理
| 项目 | 内容 |
|------|------|
| **目标界面** | b2-発注検索 |
| **功能描述** | 订单信息搜索和列表展示 |
| **跳转触发** | 点击菜单项 |
| **前置条件** | 用户已登录，权限>=1 |

#### ⑵ 実績管理
| 项目 | 内容 |
|------|------|
| **目标界面** | b4-実績検索 |
| **功能描述** | 业绩信息搜索和详情查看 |
| **跳转触发** | 点击菜单项 |
| **前置条件** | 用户已登录，权限>=1 |

#### ⑶ 被請求管理
| 项目 | 内容 |
|------|------|
| **目标界面** | b6-被請求管理 |
| **功能描述** | 被请求信息管理和文件下载 |
| **跳转触发** | 点击菜单项 |
| **前置条件** | 用户已登录，权限>=1 |

#### ⑷ CSVアップロード
| 项目 | 内容 |
|------|------|
| **目标界面** | b8-CSVアップロード |
| **功能描述** | BOSS系统CSV文件上传 |
| **跳转触发** | 点击菜单项 |
| **前置条件** | 用户已登录，权限>=1 |

#### ⑸ アクション履歴
| 项目 | 内容 |
|------|------|
| **目标界面** | b9-アクション履歴 |
| **功能描述** | 系统操作历史记录查询 |
| **跳转触发** | 点击菜单项 |
| **前置条件** | 用户已登录（仅查看） |

#### ⑹ マスタ管理
| 项目 | 内容 |
|------|------|
| **目标界面** | b10-マスタ管理 |
| **功能描述** | 账户信息管理入口 |
| **跳转触发** | 点击菜单项 |
| **前置条件** | 用户已登录，权限>=1 |

#### ⑺ ログアウト
| 项目 | 内容 |
|------|------|
| **目标界面** | b1-スタート |
| **功能描述** | 用户退出系统 |
| **跳转触发** | 点击菜单项 |
| **前置条件** | 用户已登录 |
| **特殊处理** | 清除会话，返回起始页面 |

---

## 3. 权限配置

### 3.1 权限矩阵

| 菜单项 | 管理者 | 発注担当 | 配車担当 | 計上担当 | 显示逻辑 |
|--------|--------|---------|---------|---------|----------|
| 発注管理 | △ | ○ | ○ | △ | 发注/配车可编辑，其他可查看 |
| 実績管理 | △ | ○ | ○ | △ | 发注/配车可编辑，其他可查看 |
| 被請求管理 | △ | × | △ | ○ | 计上可编辑，配车可查看，发注不可见 |
| CSVアップロード | △ | ○ | ○ | △ | 发注/配车可编辑，其他可查看 |
| アクション履歴 | △ | △ | △ | △ | 所有角色仅可查看 |
| マスタ管理 | ○ | ○ | × | × | 管理/发注可编辑，配车/计上不可见 |
| ログアウト | - | - | - | - | 所有角色可用 |

### 3.2 权限符号说明
| 符号 | 值 | UI处理 |
|------|-----|--------|
| **○** | 2 | 显示+可用+可编辑 |
| **△** | 1 | 显示+可用+只读 |
| **×** | 0 | 隐藏或不显示 |
| **-** | -1 | 显示+可用 |

---

## 4. 界面规范

### 4.1 视觉规范（b0特定）

| 属性 | PC端值 | 说明 |
|------|--------|------|
| **宽度** | 250px | 固定宽度 |
| **位置** | 左侧固定 | sticky定位 |
| **背景色** | #FFFFFF | 白色背景 |
| **边框** | 1px solid #E0E0E0 | 浅灰色边框 |
| **高度** | 100vh | 全屏高度 |
| **z-index** | 100 | 确保在最上层 |

### 4.2 菜单项样式

| 状态 | 背景色 | 文字颜色 | 边框 |
|------|--------|----------|------|
| **默认** | transparent | #333333 | 无 |
| **悬停** | #F5F5F5 | #2196F3 | 左侧2px solid #2196F3 |
| **选中** | #E3F2FD | #1976D2 | 左侧2px solid #1976D2 |
| **禁用** | #F5F5F5 | #9E9E9E | 无 |

### 4.3 层级缩进

| 层级 | 缩进 | 字体大小 | 字重 |
|------|------|----------|------|
| **一级菜单** | 0px | 14px | Bold |
| **二级菜单** | 16px | 14px | Normal |
| **三级菜单** | 32px | 13px | Normal |

---

## 5. 交互规范

### 5.1 点击行为
| 操作 | 行为 | 反馈 |
|------|------|------|
| **点击菜单项** | 跳转到目标界面 | 页面过渡动画 |
| **悬停菜单项** | 变色+左边框 | 视觉反馈 |
| **长按菜单项** | 显示tooltip | 显示完整名称 |

### 5.2 状态管理
| 状态 | 触发条件 | UI表现 |
|------|----------|--------|
| **当前页面** | URL匹配当前菜单 | 高亮显示 |
| **子菜单展开** | 点击父菜单 | 显示子菜单 |
| **子菜单收起** | 点击收起按钮 | 隐藏子菜单 |

### 5.3 过渡动画

| 场景 | 动画类型 | 时长 | 缓动 |
|------|----------|------|------|
| **菜单展开** | slideDown | 200ms | easeOut |
| **菜单收起** | slideUp | 200ms | easeIn |
| **页面跳转** | fadeOut/fadeIn | 300ms | ease |

---

## 6. 设备适配

### 6.1 PC端适配
| 特性 | 实现方式 | 说明 |
|------|----------|------|
| **固定位置** | position: sticky | 左侧固定 |
| **常时显示** | 默认展开 | 不需要折叠 |
| **全高度** | height: 100vh | 占满屏幕高度 |

### 6.2 SP端适配
| 特性 | 实现方式 | 说明 |
|------|----------|------|
| **不支持** | 不渲染/隐藏 | ≪PC≫标识 |
| **替代方案** | 汉堡菜单 | 需要单独实现（参考p0） |

---

## 7. 数据库设计

### 7.1 菜单表结构

详细数据库设计请参考：

👉 **[\_公共技术架构规范.md](../_公共技术架构规范.md)#5-数据库设计规范**

### 7.2 b0特定字段
```sql
-- b0菜单表
CREATE TABLE m_menu (
    id BIGSERIAL PRIMARY KEY,
    menu_id VARCHAR(20) NOT NULL UNIQUE,
    menu_name VARCHAR(100) NOT NULL,
    parent_id BIGINT,
    path VARCHAR(200),
    icon VARCHAR(100),
    sort_order INTEGER DEFAULT 0,
    menu_type VARCHAR(20),  -- directory, page
    is_active BOOLEAN DEFAULT TRUE
);
```

---

## 8. API接口设计

### 8.1 菜单API

详细API设计请参考：

👉 **[\_公共技术架构规范.md](../_公共技术架构规范.md)#4-api接口规范**

### 8.2 b0特定接口
```yaml
# 获取用户菜单
GET /api/v1/menus/user
Authorization: Bearer {token}

# 获取菜单树（按角色过滤）
GET /api/v1/menus/tree/{roleId}
Authorization: Bearer {token}
```

---

## 9. 前端实现

### 9.1 菜单组件

详细前端架构请参考：

👉 **[\_公共技术架构规范.md](../_公共技术架构规范.md)#2-前端架构规范**

### 9.2 b0特定组件
```typescript
// b0侧边栏组件
import { Menu } from 'antd';
import { useNavigate } from 'react-router-dom';
import { useMenuStore } from '@/stores/menuStore';
import { usePermissionStore } from '@/stores/permissionStore';

export const SideMenu: React.FC = () => {
  const navigate = useNavigate();
  const { menuItems } = useMenuStore();
  const { permissions } = usePermissionStore();
  
  // 过滤有权限的菜单项
  const filteredItems = menuItems.filter(
    item => permissions[item.id] > 0
  );
  
  // 处理菜单点击
  const handleMenuClick = ({ key }: { key: string }) => {
    const menuItem = findMenuById(filteredItems, key);
    if (menuItem?.path) {
      navigate(menuItem.path);
    }
  };
  
  return (
    <Menu
      mode="inline"
      items={filteredItems}
      onClick={handleMenuClick}
    />
  );
};
```

---

## 10. 验收标准

### 10.1 功能验收
- [ ] 菜单项根据权限正确显示/隐藏
- [ ] 点击菜单项跳转到正确界面
- [ ] ログアウト功能正常
- [ ] 当前页面菜单高亮正确

### 10.2 视觉验收
- [ ] 布局与设计稿一致
- [ ] 悬停效果正常
- [ ] 响应式适配正确
- [ ] 层级缩进正确

### 10.3 性能验收
- [ ] 菜单渲染时间 < 100ms
- [ ] 权限计算时间 < 50ms
- [ ] 支持页面刷新状态保持
- [ ] 无闪烁或跳动

### 10.4 安全验收
- [ ] 无权限菜单不显示
- [ ] 会话超时自动跳转登录
- [ ] 防止XSS攻击
- [ ] CSRF防护生效

---

## 11. 变更日志

| 日期 | 版本 | 变更内容 | 作者 |
|------|------|---------|------|
| 2026-02-XX| v1.0 | 初始版本 | - |

---

## 附录

### A.1 与p0-共通ナビゲーション对比

| 特性 | b0-共通ナビゲーション | p0-共通ナビゲーション |
|------|----------------------|----------------------|
| **用户类型** | ベース | 輸送パートナー |
| **设备支持** | PCのみ | PC/SP |
| **菜单项数** | 7 | 5 |
| **功能范围** | 完整管理 | 限定操作 |
| **SP适配** | 不支持 | ハンバーガーメニュー |

### A.2 相关文档
| 文档 | 路径 | 说明 |
|------|------|------|
| 公共技术架构规范 | [\_公共技术架构规范.md](../_公共技术架构规范.md) | 前后端技术架构详细规范 |
| 画面遷移図设计规范 | [../画面遷移図/05_设计规范.md](../画面遷移図/05_设计规范.md) | 导航流程设计规范 |
| 画面一覧设计规范 | [../画面一覧/05_设计规范.md](../画面一覧/05_设计规范.md) | 界面清单和权限配置 |

---

**文档编制**: -  
**编制时间**: 2026-02-XX 
**适用范围**: 別紙_画面一覧_v151.xlsx - b0-共通ナビゲーション  
**交叉引用**: [\_公共技术架构规范.md](../_公共技术架构规范.md)