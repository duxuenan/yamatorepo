# 画面一覧 - 设计规范

## 1. 功能概述

### 1.1 文档信息
| 项目 | 内容 |
|------|------|
| **工作表名称** | 画面一覧 |
| **文档版本** | v1.0 |
| **最后更新** | 2026-02-XX|
| **文档状态** | ✅ 已发布 |

### 1.2 功能描述
本文档定义了系统中所有界面的清单和权限配置，是系统安全设计和用户权限管理的基础规范。

### 1.3 技术架构
本文档基于 **前后端分离架构**，详细技术规范请参考：

👉 **[\_公共技术架构规范.md](../_公共技术架构规范.md)**

| 层级 | 技术 |
|------|------|
| 前端 | React 18.x + TypeScript |
| 后端 | Spring Boot 3.x + Java 17 |
| 数据库 | PostgreSQL 15.x |
| 认证 | OAuth 2.0 + JWT |

### 1.4 适用范围
- 系统开发人员（界面实现）
- 测试工程师（权限测试）
- 安全管理员（权限审核）
- 产品经理（功能规划）

---

## 2. 界面清单

### 2.1 基础用户界面（ベース）- 16个

| 编号 | 界面名称 | 路由路径 | 组件名称 | 设备支持 |
|------|----------|----------|----------|----------|
| b0 | 共通ナビゲーション | /b0 | CommonNavigation | PC |
| b1 | スタート | /b1 | StartPage | PC |
| b2 | 発注検索 | /b2 | OrderSearch | PC |
| b3 | 発注詳細 | /b3 | OrderDetail | PC |
| b4 | 実績検索 | /b4 | CompletedOrderSearch | PC |
| b5 | 実績詳細 | /b5 | CompletedOrderDetail | PC |
| b6 | 被請求管理 | /b6 | ClaimManagement | PC |
| b7 | 被請求詳細 | /b7 | ClaimDetail | PC |
| b8 | CSVアップロード | /b8 | CsvUpload | PC |
| b9 | アクション履歴 | /b9 | ActionHistory | PC |
| b10 | マスタ管理 | /b10 | MasterManagement | PC |
| b11 | 輸送パートナーマスタ検索 | /b11 | PartnerSearch | PC |
| b12 | 輸送パートナー詳細（会社） | /b12 | PartnerCompanyDetail | PC |
| b13 | 輸送パートナー詳細（ユーザー） | /b13 | PartnerUserDetail | PC |
| b14 | ベースアカウントマスタ検索 | /b14 | AccountSearch | PC |
| b15 | ベースアカウントマスタ詳細 | /b15 | AccountDetail | PC |

### 2.2 运输合作伙伴界面（輸送パートナー）- 6个

| 编号 | 界面名称 | 路由路径 | 组件名称 | 设备支持 |
|------|----------|----------|----------|----------|
| p0 | 共通ナビゲーション | /p0 | CommonNavigation | PC/SP |
| p1 | スタート | /p1 | StartPage | PC/SP |
| p2 | 発注検索 | /p2 | OrderSearch | PC/SP |
| p3 | 発注詳細 | /p3 | OrderDetail | PC/SP |
| p4 | 実績確認 | /p4 | CompletedOrderConfirm | PC/SP |
| p5 | 請求検索 | /p5 | ClaimSearch | PC/SP |
| p6 | 請求書アップロード | /p6 | ClaimUpload | PC/SP |

---

## 3. 权限配置规范

### 3.1 权限符号定义
| 符号 | 值 | 说明 | 前端处理 | 后端验证 |
|------|-----|------|----------|----------|
| **○** | 2 | 編集可 | 显示+可用+可编辑 | @PreAuthorize |
| **△** | 1 | 閲覧のみ | 显示+可用+只读 | @PreAuthorize |
| **×** | 0 | 閲覧不可 | 不渲染组件 | 403 Forbidden |
| **-** | -1 | 非対象 | 根据角色决定 | N/A |

### 3.2 角色定义

| 角色ID | 角色名称 | 说明 |
|--------|----------|------|
| R01 | 管理者 | 系统管理员，拥有最高权限 |
| R02 | 発注担当者 | 订单操作员 |
| R03 | 配車担当者 | 配车操作员 |
| R04 | 計上担当者 | 财务核算员 |
| R05 | 輸送パートナー | 运输合作伙伴 |

### 3.3 权限矩阵

#### 基础用户权限矩阵
| 界面 | 管理者 | 発注担当 | 配車担当 | 計上担当 |
|------|--------|---------|---------|---------|
| b0-共通ナビゲーション | - | - | - | - |
| b1-スタート | ○ | ○ | ○ | ○ |
| b2-発注検索 | △ | ○ | ○ | △ |
| b3-発注詳細 | △ | ○ | ○ | △ |
| b4-実績検索 | △ | ○ | ○ | △ |
| b5-実績詳細 | △ | ○ | ○ | △ |
| b6-被請求管理 | △ | × | △ | ○ |
| b7-被請求詳細 | △ | × | △ | ○ |
| b8-CSVアップロード | △ | ○ | ○ | △ |
| b9-アクション履歴 | △ | △ | △ | △ |
| b10-マスタ管理 | ○ | ○ | × | × |
| b11-輸送パートナーマスタ検索 | ○ | ○ | × | × |
| b12-輸送パートナー詳細（会社） | ○ | ○ | × | × |
| b13-輸送パートナー詳細（ユーザー） | ○ | ○ | × | × |
| b14-ベースアカウントマスタ検索 | ○ | × | × | × |
| b15-ベースアカウントマスタ詳細 | ○ | × | × | × |

#### 运输合作伙伴权限矩阵
| 界面 | 輸送パートナー |
|------|-------------|
| p0-共通ナビゲーション | - |
| p1-スタート | ○ |
| p2-発注検索 | ○ |
| p3-発注詳細 | ○ |
| p4-実績確認 | ○ |
| p5-請求検索 | ○ |
| p6-請求書アップロード | ○ |

---

## 4. 字段定义

### 4.1 界面清单字段

| 字段名 | 数据类型 | 必填 | 说明 |
|--------|----------|------|------|
| screen_id | String | ✅ | 格式：[b/p][0-9]+，如 b2, p3 |
| screen_name | String | ✅ | 界面显示名称 |
| category | String | ✅ | 功能分类 |
| description | String | ✅ | 功能简要描述 |
| route_path | String | ✅ | 前端路由路径 |
| component_name | String | ✅ | React组件名称 |
| device_pc | Boolean | ✅ | 是否支持PC |
| device_sp | Boolean | ✅ | 是否支持SP |
| sort_order | Integer | ❌ | 排序序号 |

### 4.2 权限字段

| 字段名 | 数据类型 | 必填 | 说明 |
|--------|----------|------|------|
| role_id | String | ✅ | 角色ID |
| screen_id | String | ✅ | 界面ID |
| access_level | Integer | ✅ | 0/1/2/-1 |
| can_read | Boolean | ✅ | 是否可读 |
| can_write | Boolean | ✅ | 是否可写 |
| can_delete | Boolean | ✅ | 是否可删除 |

---

## 5. 业务规则

### 5.1 界面编号规则
```
规则: [用户类型][序号]

用户类型:
- b = ベース（基础用户）
- p = 輸送パートナー（运输合作伙伴）

序号: 00-99 的数字

示例:
- b0 = 基础用户第0个界面
- p1 = 运输合作伙伴第1个界面
```

### 5.2 权限继承规则
1. 子界面权限继承父界面权限
2. 子界面可单独配置权限覆盖继承
3. 权限最小化原则：默认无权限，需要明确授权

### 5.3 设备支持规则
1. PC/SP双支持：响应式设计
2. PC仅支持：固定布局，大屏幕优化
3. SP仅支持：移动优先设计

---

## 6. 数据库设计

### 6.1 表结构

详细数据库设计请参考：

👉 **[\_公共技术架构规范.md](../_公共技术架构规范.md)#5-数据库设计规范**

### 6.2 核心表

**m_screen（画面表）**
```sql
CREATE TABLE m_screen (
    id BIGSERIAL PRIMARY KEY,
    screen_id VARCHAR(20) NOT NULL UNIQUE,
    screen_name VARCHAR(100) NOT NULL,
    category VARCHAR(50),
    description TEXT,
    route_path VARCHAR(100),
    component_name VARCHAR(100),
    device_pc BOOLEAN DEFAULT FALSE,
    device_sp BOOLEAN DEFAULT FALSE,
    sort_order INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**m_permission（权限表）**
```sql
CREATE TABLE m_permission (
    id BIGSERIAL PRIMARY KEY,
    role_id VARCHAR(20) NOT NULL,
    screen_id VARCHAR(20) NOT NULL,
    access_level INTEGER NOT NULL CHECK (access_level IN (0, 1, 2)),
    can_read BOOLEAN DEFAULT FALSE,
    can_write BOOLEAN DEFAULT FALSE,
    can_delete BOOLEAN DEFAULT FALSE,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    CONSTRAINT uk_role_screen UNIQUE (role_id, screen_id)
);
```

---

## 7. API接口设计

### 7.1 界面管理API

详细API设计请参考：

👉 **[\_公共技术架构规范.md](../_公共技术架构规范.md)#4-api接口规范**

### 7.2 核心接口

```yaml
# 获取所有界面列表
GET /api/v1/screens
Authorization: Bearer {token}

# 获取用户可访问的界面列表
GET /api/v1/screens/accessible
Authorization: Bearer {token}

# 检查界面权限
GET /api/v1/screens/{screenId}/permission
Authorization: Bearer {token}

# 获取权限矩阵
GET /api/v1/permissions/matrix
Authorization: Bearer {token} (require: admin)
```

---

## 8. 前端实现

### 8.1 前端类型定义

详细前端架构请参考：

👉 **[\_公共技术架构规范.md](../_公共技术架构规范.md)#2-前端架构规范**

### 8.2 核心类型
```typescript
// 界面类型
export interface Screen {
  screenId: string;
  screenName: string;
  category: string;
  description: string;
  routePath: string;
  componentName: string;
  devicePc: boolean;
  deviceSp: boolean;
  sortOrder: number;
}

// 权限级别
export type AccessLevel = 2 | 1 | 0 | -1;

// 权限配置
export interface Permission {
  screenId: string;
  accessLevel: AccessLevel;
  canRead: boolean;
  canWrite: boolean;
  canDelete: boolean;
}
```

---

## 9. 验收标准

### 9.1 功能验收
- [ ] 界面列表与本文档完全一致
- [ ] 权限配置与矩阵完全一致
- [ ] 设备支持标识正确
- [ ] 界面编号唯一且连续

### 9.2 安全验收
- [ ] 权限控制生效
- [ ] 无权限界面无法访问
- [ ] 权限变更实时生效
- [ ] 审计日志完整

### 9.3 性能验收
- [ ] 权限查询响应时间 < 100ms
- [ ] 界面列表加载时间 < 500ms
- [ ] 支持1000+并发用户

---

## 10. 变更日志

| 日期 | 版本 | 变更内容 | 作者 |
|------|------|---------|------|
| 2026-02-XX| v1.0 | 初始版本 | - |

---

## 附录

### A.1 界面分类统计
| 分类 | 数量 | 占比 |
|------|------|------|
| 导航模块 | 2 | 9.09% |
| 起始模块 | 2 | 9.09% |
| 订单管理 | 3 | 13.64% |
| 业绩管理 | 4 | 18.18% |
| 计费管理 | 4 | 18.18% |
| 数据管理 | 2 | 9.09% |
| 主数据管理 | 5 | 22.73% |
| **总计** | **22** | **100%** |

### A.2 设备支持统计
| 支持类型 | 数量 | 占比 |
|----------|------|------|
| PCのみ | 16 | 72.73% |
| PC/SP | 6 | 27.27% |

### A.3 相关文档
| 文档 | 路径 | 说明 |
|------|------|------|
| 公共技术架构规范 | [\_公共技术架构规范.md](../_公共技术架构规范.md) | 前后端技术架构详细规范 |
| 画面遷移図设计规范 | [../画面遷移図/05_设计规范.md](../画面遷移図/05_设计规范.md) | 导航流程设计规范 |
| b0设计规范 | [../b0-共通ナビゲーション/05_设计规范.md](../b0-共通ナビゲーション/05_设计规范.md) | 导航菜单设计规范 |

---

**文档编制**: -  
**编制时间**: 2026-02-XX 
**适用范围**: 別紙_画面一覧_v151.xlsx - 画面一覧  
**交叉引用**: [\_公共技术架构规范.md](../_公共技术架构规范.md)