# b5-実績詳細 - 设计规范

## 1. 功能概述

### 1.1 文档信息
| 项目 | 内容 |
|------|------|
| **工作表名称** | b5-実績詳細 |
| **界面编号** | b5 |
| **文档版本** | v1.0 |
| **最后更新** | 2026-02-XX|
| **文档状态** | ✅ 已发布 |

### 1.2 功能描述
b5-実績詳細 是业绩详情页面，提供业绩详细信息展示和日别傭车费一览的编辑、发送功能。

### 1.3 技术架构
本文档基于 **前后端分离架构**，详细技术规范请参考：

👉 **[\_公共技术架构规范.md](../_公共技术架构规范.md)**

| 层级 | 技术 |
|------|------|
| 前端 | React 18.x + TypeScript + Ant Design |
| 后端 | Spring Boot 3.x + Java 17 |

### 1.4 核心功能
- 輸送パートナー情報表示
- 状態進捗表示
- 日別傭車費一覧編集
- 送付功能
- アクション履歴表示
- メッセージ交流

### 1.5 适用范围
- 前端开发人员（详情页面组件实现）
- 后端开发人员（业绩/费用API开发）
- 测试工程师（详情功能测试）

---

## 2. 页面元素

### 2.1 元素清单

| 序号 | 元素名称 | 元素类型 | 功能说明 | 交互触发 |
|------|----------|----------|----------|----------|
| ⑴ | 輸送パートナー情報 | 表示区域 | 輸送パートナーID/名 | - |
| ⑵ | 状態表示 | 表示区域 | 発注ID/ステータス/version/指示書送付/承諾 | - |
| ⑶ | 日別傭車費一覧 | テーブル | 費用表格 | 編集/保存/送付 |
| ⑷ | 月間運行指示書 | テーブル | 確定版指示書 | 表示のみ |
| ⑸ | アクション履歴 | リスト | 行为历史 | 表示 |
| ⑹ | メッセージ | パネル | 消息交流 | 表示/入力/送信 |

### 2.2 状態区域字段说明
| 字段 | 元素类型 | 说明 |
|------|----------|------|
| 発注ID | Text（只读） | 発注対象の発注IDを表示する |
| ステータス | Tag | 「全承諾」「未承諾」のどちらかを表示する |
| version | Text（只读） | 月間運行指示書の最新version（数字）を表示する |
| 指示書送付 | Text（只读） | 輸送パートナーへ指示書を送付した日時を表示する |
| 承諾 | Text（只读） | 輸送パートナーが承諾した日時を表示する |

### 2.3 日別傭車費一覧字段
| 字段 | 元素类型 | 功能说明 | 交互 |
|------|----------|----------|------|
| 線便コード | Text | 线路代码 | 表示 |
| 線便名 | Text | 线路名称 | 表示 |
| 土/日/月/火/水/木/金 | Button | 日期金额 | 点击编辑 |
| 承認済/未承認/差戻し | Tag | 状态 | 显示/切换 |
| version | Select | 版本选择 | プルダウン |

### 2.4 差戻し状态说明
| 状态 | 条件 | 操作 |
|------|------|------|
| 承認済 | 已承认 | 点击后可显示[差戻し]按钮 |
| 未承認 | 未承认 | - |
| 差戻し | 退回 | 从承認済状态点击可退回至未承認 |

### 2.2 Tabs组件
| Tab名 | 内容 | 权限 |
|-------|------|------|
| 確定前 | 日別傭車費一覧 | 可编辑 |
| 確定後 | 月間運行指示書（確定版） | 只读 |

### 2.3 日別傭車費一覧字段
| 字段 | 元素类型 | 功能说明 | 交互 |
|------|----------|----------|------|
| 線便コード | Text | 线路代码 | 表示 |
| 線便名 | Text | 线路名称 | 表示 |
| 土/日/月/火/水/木/金 | Button | 日期金额 | 点击编辑 |
| version | Select | 版本选择 | プルダウン |

---

## 3. 交互流程

### 3.1 Tabs切换流程
| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击Tab | 切换显示内容 |
| 2 | 確定前 | 显示日別傭車費一覧（可编辑） |
| 3 | 確定後 | 显示確定版指示書（只读） |

### 3.2 费用编辑流程
| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击金額格子 | 显示吹き出し |
| 2 | 输入変更内容 | 背景強調表示 |
| 3 | 点击変更を保存 | 保存数据 |
| 4 | 保存成功 | 显示成功提示 |

### 3.3 送付流程
| 步骤 | 用户操作 | 系统响应 |
|------|----------|----------|
| 1 | 点击送付按钮 | 显示确认对话框 |
| 2 | 确认发送 | 执行发送 |
| 3 | 发送成功 | 更新状态 |

---

## 4. 界面规范

### 4.1 页面布局
| 属性 | PC端值 | SP端值 | 说明 |
|------|--------|--------|------|
| **页面类型** | PC | 不支持 | ≪PC≫标识 |
| **布局方式** | 多区域组合+Tabs | - | Tab切换+表格 |

### 4.2 Tabs规范
| 属性 | 值 |
|------|-----|
| **Tab位置** | 顶部 |
| **Tab数** | 2 |
| **默认选中** | 確定前 |

### 4.3 表格规范
| 属性 | 值 |
|------|-----|
| **行高** | 固定高度 |
| **列宽** | 根据内容自适应 |
| **横向滚动** | 需要 |

---

## 5. API接口设计

### 5.1 业绩详情API
```yaml
# 获取业绩详情
GET /api/v1/completed-orders/{completedOrderId}
Authorization: Bearer {token}
```

### 5.2 费用表格API
```yaml
# 获取费用列表
GET /api/v1/completed-orders/{completedOrderId}/daily-costs
Authorization: Bearer {token}

# 保存费用变更
PUT /api/v1/completed-orders/{completedOrderId}/daily-costs
Authorization: Bearer {token}
Body: { changes: [...] }

# 送付费用
POST /api/v1/completed-orders/{completedOrderId}/daily-costs/send
Authorization: Bearer {token}
```

---

## 6. 前端实现

### 6.1 Tabs组件
```typescript
// b5 Tabs组件
import { Tabs } from 'antd';

export const B5DetailPage: React.FC = () => {
  return (
    <Tabs defaultActiveKey="before">
      <Tabs.TabPane tab="確定前" key="before">
        <DailyCostTable />
      </Tabs.TabPane>
      <Tabs.TabPane tab="確定後" key="after">
        <ConfirmedInstruction />
      </Tabs.TabPane>
    </Tabs>
  );
};
```

---

## 7. 验收标准

### 7.1 功能验收
- [ ] 正确显示业绩详情
- [ ] Tabs切换正常
- [ ] 確定前：编辑功能正常
- [ ] 確定後：只读显示正常
- [ ] 保存功能正常
- [ ] 送付功能正常
- [ ] メッセージ功能正常

### 7.2 视觉验收
- [ ] 布局与设计稿一致
- [ ] Tabs切换正确
- [ ] 表格显示正确

### 7.3 性能验收
- [ ] 页面加载 < 3秒
- [ ] 表格渲染 < 2秒
- [ ] 保存操作 < 1秒

---

## 8. 变更日志

| 日期 | 版本 | 变更内容 | 作者 |
|------|------|---------|------|
| 2026-02-XX| v1.0 | 初始版本 | - |

---

## 附录

### A.1 相关文档
| 文档 | 路径 | 说明 |
|------|------|------|
| 公共技术架构规范 | [\_公共技术架构规范.md](../_公共技术架构规范.md) | 前后端技术架构详细规范 |
| b4-実績検索 | [../b4-実績検索/05_设计规范.md](../b4-実績検索/05_设计规范.md) | 列表页面设计规范 |

### A.2 与b3-発注詳細对比
| 特性 | b3-発注詳細 | b5-実績詳細 |
|------|-------------|-------------|
| **用户类型** | ベース | ベース |
| **Tab切换** | なし | あり |
| **表格类型** | 月間運行指示書 | 日別傭車費一覧 |
| **金额字段** | なし | あり |

---

**文档编制**: -  
**编制时间**: 2026-02-XX 
**适用范围**: 別紙_画面一覧_v151.xlsx - b5-実績詳細  
**交叉引用**: [\_公共技术架构规范.md](../_公共技术架构规范.md)
