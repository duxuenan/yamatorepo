# APIæ¥å£è®¾è®¡æ€»è§ˆ

## ğŸ“‹ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå** | å¤§è³€è¼¸é€æ–°ã‚·ã‚¹ãƒ†ãƒ  |
| **APIãƒãƒ¼ã‚¸ãƒ§ãƒ³** | v1.0 |
| **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³** | v1.0 |
| **ä½œæˆæ—¥** | 2026-02-XX|
| **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹** | âœ… å®Œäº† |

---

## 1. APIã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### 1.1 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ |
|------|------|
| **APIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯** | Spring Boot 3.x |
| **ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª** | Java 17 |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£** | JWT (Bearer Token) |
| **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³** | OpenAPI 3.0 |
| **ãƒ¬ãƒ¼ãƒˆåˆ¶é™** | Redisãƒ™ãƒ¼ã‚¹ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ |

### 1.2 ãƒ™ãƒ¼ã‚¹URL

```
æœ¬ç•ªç’°å¢ƒ: https://api.yamato-transport.co.jp/api/v1
é–‹ç™ºç’°å¢ƒ: https://api-dev.yamato-transport.co.jp/api/v1
ãƒ†ã‚¹ãƒˆç’°å¢ƒ: https://api-test.yamato-transport.co.jp/api/v1
```

### 1.3 èªè¨¼ãƒ»èªå¯

ã™ã¹ã¦ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¯Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ãŒå¿…è¦:

```http
Authorization: Bearer {jwt_token}
Content-Type: application/json
```

---

## 2. APIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§

### 2.1 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ

```
APIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ
â”œâ”€â”€ èªè¨¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â””â”€â”€ /api/v1/auth
â”œâ”€â”€ ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â””â”€â”€ /api/v1/partners
â”œâ”€â”€ ç™ºæ³¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â””â”€â”€ /api/v1/orders
â”œâ”€â”€ å®Ÿç¸¾ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â””â”€â”€ /api/v1/completed-orders
â”œâ”€â”€ è«‹æ±‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â””â”€â”€ /api/v1/billings
â”œâ”€â”€ ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â””â”€â”€ /api/v1/uploads
â”œâ”€â”€ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å±¥æ­´ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â””â”€â”€ /api/v1/action-history
â”œâ”€â”€ ãƒ™ãƒ¼ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â””â”€â”€ /api/v1/base-accounts
â”œâ”€â”€ ãƒã‚¹ã‚¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â””â”€â”€ /api/v1/master
â””â”€â”€ å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æºãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
    â””â”€â”€ /api/v1/external
```

### 2.2 ç”»é¢åˆ¥APIä¸€è¦§

| ç”»é¢ID | ç”»é¢åç§° | API Endpoint | HTTPãƒ¡ã‚½ãƒƒãƒ‰ |
|--------|---------|-------------|------------|
| b0 | å…±é€šãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ | - | - |
| b1 | ã‚¹ã‚¿ãƒ¼ãƒˆ | /api/v1/dashboard | GET |
| b2 | ç™ºæ³¨æ¤œç´¢ | /api/v1/orders/search | GET |
| b3 | ç™ºæ³¨è©³ç´° | /api/v1/orders/{orderId} | GET, PUT |
| b4 | å®Ÿç¸¾æ¤œç´¢ | /api/v1/completed-orders/search | GET |
| b5 | å®Ÿç¸¾è©³ç´° | /api/v1/completed-orders/{completedOrderId} | GET, PUT |
| b6 | è¢«è«‹æ±‚ç®¡ç† | /api/v1/billings/search | GET |
| b7 | è¢«è«‹æ±‚è©³ç´° | /api/v1/billings/{billingId} | GET |
| b8 | CSVã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ | /api/v1/uploads | POST |
| b9 | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å±¥æ­´ | /api/v1/action-history/search | GET |
| b10 | ãƒã‚¹ã‚¿ç®¡ç† | - | - |
| b11 | è¼¸é€ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãƒã‚¹ã‚¿æ¤œç´¢ | /api/v1/partners/search | GET |
| b12 | è¼¸é€ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãƒã‚¹ã‚¿è©³ç´°ï¼ˆä¼šç¤¾ï¼‰ | /api/v1/partners/{companyId} | GET, PUT |
| b13 | è¼¸é€ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼è©³ç´°ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ | /api/v1/partner-users/{userId} | GET, PUT |
| b14 | ãƒ™ãƒ¼ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒã‚¹ã‚¿æ¤œç´¢ | /api/v1/base-accounts/search | GET |
| b15 | ãƒ™ãƒ¼ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè©³ç´° | /api/v1/base-accounts/{userId} | GET, PUT |
| p0 | å…±é€šãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ | - | - |
| p1 | ã‚¹ã‚¿ãƒ¼ãƒˆ | /api/v1/partner/dashboard | GET |
| p2 | ç™ºæ³¨æ¤œç´¢ | /api/v1/partner/orders/search | GET |
| p3 | ç™ºæ³¨è©³ç´° | /api/v1/partner/orders/{orderId} | GET, POST |
| p4 | å®Ÿç¸¾ç¢ºèª | /api/v1/partner/completed-orders/{completedOrderId} | GET |
| p5 | è«‹æ±‚æ¤œç´¢ | /api/v1/partner/billings/search | GET |
| p6 | æƒ…å ±ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ | /api/v1/partner/uploads | POST, GET |

---

## 3. å…±é€šä»•æ§˜

### 3.1 ãƒ¬ã‚¹ãƒãƒ³ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

ã™ã¹ã¦ã®APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯çµ±ä¸€ã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:

```json
{
  "success": true,
  "code": "SUCCESS",
  "message": "Operation completed successfully",
  "data": {
    // å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿
  },
  "pagination": {
    "currentPage": 1,
    "pageSize": 20,
    "totalItems": 100,
    "totalPages": 5
  },
  "timestamp": "2026-02-xxT10:30:00Z"
}
```

### 3.2 ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
  "success": false,
  "code": "VALIDATION_ERROR",
  "message": "Validation failed for the request",
  "errors": [
    {
      "field": "email",
      "message": "Invalid email format"
    }
  ],
  "timestamp": "2026-02-xxT10:30:00Z"
}
```

### 3.3 HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰

| ã‚³ãƒ¼ãƒ‰ | æ„å‘³ | ä½¿ç”¨å ´é¢ |
|--------|------|---------|
| 200 | OK | æˆåŠŸ |
| 201 | Created | ãƒªã‚½ãƒ¼ã‚¹ä½œæˆæˆåŠŸ |
| 400 | Bad Request | ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ |
| 401 | Unauthorized | èªè¨¼ã‚¨ãƒ©ãƒ¼ |
| 403 | Forbidden | æ¨©é™ã‚¨ãƒ©ãƒ¼ |
| 404 | Not Found | ãƒªã‚½ãƒ¼ã‚¹ä¸å­˜åœ¨ |
| 409 | Conflict | ç«¶åˆã‚¨ãƒ©ãƒ¼ |
| 422 | Unprocessable Entity | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ |
| 429 | Too Many Requests | ãƒ¬ãƒ¼ãƒˆåˆ¶é™ |
| 500 | Internal Server Error | ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ |

### 3.4 ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³

```typescript
interface PaginationRequest {
  page?: number;      // ãƒšãƒ¼ã‚¸ç•ªå· (1ã‹ã‚‰é–‹å§‹)
  pageSize?: number;  // 1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®ä»¶æ•° (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 20)
  sort?: string;      // ä¸¦ã³æ›¿ãˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  sortOrder?: 'asc' | 'desc';  // ä¸¦ã³æ›¿ãˆé †åº
}

interface PaginationResponse {
  currentPage: number;
  pageSize: number;
  totalItems: number;
  totalPages: number;
  hasNext: boolean;
  hasPrevious: boolean;
}
```

---

## 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### 4.1 JWTãƒˆãƒ¼ã‚¯ãƒ³

```typescript
interface JWTPayload {
  sub: string;              // ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
  type: 'partner' | 'base'; // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—
  permissions: string[];   // æ¨©é™ãƒªã‚¹ãƒˆ
  companyId?: string;      // ä¼šç¤¾ID (ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å ´åˆ)
  baseId?: string;         // ãƒ™ãƒ¼ã‚¹ID (ãƒ™ãƒ¼ã‚¹å ´åˆ)
  iat: number;             // ç™ºè¡Œæ™‚åˆ»
  exp: number;             // æœ‰åŠ¹æœŸé™
}
```

### 4.2 ãƒ¬ãƒ¼ãƒˆåˆ¶é™

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚¿ã‚¤ãƒ— | ãƒ¬ãƒ¼ãƒˆåˆ¶é™ |
|-------------------|-----------|
| æ¤œç´¢API | 60 requests/minute |
| å‚ç…§API | 120 requests/minute |
| æ›´æ–°API | 30 requests/minute |
| ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰API | 10 requests/minute |

---

## 5. APIãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†

### 5.1 ãƒãƒ¼ã‚¸ãƒ§ãƒ³æˆ¦ç•¥

- **ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: URLãƒ‘ã‚¹ã«å«ã‚€ (`/api/v1/`)
- **ãƒã‚¤ãƒŠãƒ¼å¤‰æ›´**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã¿æ›´æ–°
- **ç ´å£Šçš„å¤‰æ›´**: æ–°ã—ã„ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½œæˆ

---

## 6. é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | ãƒ‘ã‚¹ |
|------|------|
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ | ../ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ/01_ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆç·è¦§.md |
| DDLã‚¹ã‚¯ãƒªãƒ—ãƒˆ | ../ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ/02_DDLã‚¹ã‚¯ãƒªãƒ—ãƒˆ.sql |
| è¨­è¨ˆæ ¹æ‹ æ›¸ | ../ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ/03_ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ ¹æ‹ æ›¸.md |
| æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ | ../åˆ¥ç´™_ç”»é¢ä¸€è¦§_v151/_å…¬å…±æŠ€æœ¯æ¶æ„è§„èŒƒ.md |

---

## 7. å¤‰æ›´ãƒ­ã‚°

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ | ä½œæˆè€… |
|------|------|---------|------|
| 2026-02-XX| v1.0 | åˆæœŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ | - |

---

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ**: -  
**ä½œæˆæ—¥æ™‚**: 2026-02-XX 
**é©ç”¨ç¯„å›²**: å¤§è³€è¼¸é€æ–°ã‚·ã‚¹ãƒ†ãƒ  APIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ
