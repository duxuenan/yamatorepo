<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>大贺运输新系统 - API文档</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; color: #333; }
        .header { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: white; padding: 40px 20px; text-align: center; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .stats-bar { display: flex; justify-content: center; gap: 30px; padding: 20px; background: white; border-bottom: 1px solid #e0e0e0; flex-wrap: wrap; }
        .stat-item { text-align: center; }
        .stat-value { font-size: 1.8rem; font-weight: bold; }
        .stat-label { font-size: 0.9rem; color: #666; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .search-box { margin: 20px 0; }
        .search-box input { width: 100%; padding: 15px; font-size: 1rem; border: 2px solid #e0e0e0; border-radius: 8px; outline: none; }
        .search-box input:focus { border-color: #1890ff; }
        .category { margin-bottom: 30px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); overflow: hidden; }
        .category-header { background: #fafafa; padding: 20px 25px; border-bottom: 1px solid #e8e8e8; }
        .category-header h2 { font-size: 1.2rem; margin-bottom: 5px; }
        .section-header { padding: 15px 25px 10px; background: #f5f5f5; font-weight: bold; font-size: 0.9rem; }
        .section-header.shared { color: #1890ff; }
        .section-header.b { color: #fa8c16; }
        .section-header.p { color: #52c41a; }
        .api-count { background: #1890ff; color: white; padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; display: inline-block; margin-top: 5px; }
        .api-list { padding: 0; }
        .api-item { padding: 12px 25px; border-bottom: 1px solid #f0f0f0; display: flex; align-items: flex-start; gap: 15px; }
        .api-item:last-child { border-bottom: none; }
        .method { padding: 4px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; min-width: 60px; text-align: center; }
        .method.GET { background: #e6f7ff; color: #1890ff; border: 1px solid #91d5ff; }
        .method.POST { background: #f6ffed; color: #52c41a; border: 1px solid #b7eb8f; }
        .method.PUT { background: #fff7e6; color: #fa8c16; border: 1px solid #ffd591; }
        .method.DELETE { background: #fff1f0; color: #ff4d4f; border: 1px solid #ffa39e; }
        .api-info { flex: 1; }
        .api-path { font-family: monospace; font-size: 0.9rem; color: #333; margin-bottom: 3px; }
        .api-desc { font-size: 0.85rem; color: #666; }
        .tag { display: inline-block; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; }
        .tag.shared { background: #e6f7ff; color: #1890ff; border: 1px solid #91d5ff; }
        .tag.b { background: #fff7e6; color: #fa8c16; border: 1px solid #ffd591; }
        .tag.p { background: #f6ffed; color: #52c41a; border: 1px solid #b7eb8f; }
        .filter-tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .filter-tab { padding: 8px 16px; background: white; border: 1px solid #d9d9d9; border-radius: 20px; cursor: pointer; font-size: 0.9rem; }
        .filter-tab:hover { border-color: #1890ff; color: #1890ff; }
        .filter-tab.active { background: #1890ff; color: white; border-color: #1890ff; }
        .sidebar { position: fixed; right: 20px; top: 200px; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); max-height: 60vh; overflow-y: auto; }
        .sidebar-link { display: block; padding: 5px 0; color: #333; text-decoration: none; font-size: 0.85rem; }
        .sidebar-link:hover { color: #1890ff; }
        .main-content { margin-right: 180px; }
        footer { text-align: center; padding: 30px; color: #888; font-size: 0.9rem; }
        @media (max-width: 768px) { .main-content { margin-right: 0; } .sidebar { display: none; } }
    </style>
</head>
<body>
    <div class="header">
        <h1>大贺运输新系统 API</h1>
        <p>Yamato Transport System - RESTful API Documentation</p>
    </div>
    
    <div class="stats-bar">
        <div class="stat-item"><div class="stat-value">72</div><div class="stat-label">API Paths</div></div>
        <div class="stat-item"><div class="stat-value">83</div><div class="stat-label">Total APIs</div></div>
        <div class="stat-item"><div class="stat-value" style="color:#1890ff">42</div><div class="stat-label">GET</div></div>
        <div class="stat-item"><div class="stat-value" style="color:#52c41a">29</div><div class="stat-label">POST</div></div>
        <div class="stat-item"><div class="stat-value" style="color:#fa8c16">10</div><div class="stat-label">PUT</div></div>
        <div class="stat-item"><div class="stat-value" style="color:#ff4d4f">2</div><div class="stat-label">DELETE</div></div>
    </div>
    
    <div class="container">
        <div class="main-content">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="搜索API... (支持路径、方法、描述)">
            </div>
            
            <div class="filter-tabs">
                <button class="filter-tab active" data-filter="all">全部</button>
                <button class="filter-tab" data-filter="GET">GET</button>
                <button class="filter-tab" data-filter="POST">POST</button>
                <button class="filter-tab" data-filter="PUT">PUT</button>
                <button class="filter-tab" data-filter="DELETE">DELETE</button>
            </div>
            
            <div id="apiContainer"></div>
        </div>
    </div>
    
    <div class="sidebar">
        <div style="font-size:0.85rem;color:#888;margin-bottom:10px;">快速导航</div>
        <a href="#cat-认证授权" class="sidebar-link">认证授权</a>
        <a href="#cat-订单管理" class="sidebar-link">订单管理</a>
        <a href="#cat-实绩管理" class="sidebar-link">实绩管理</a>
        <a href="#cat-账单管理" class="sidebar-link">账单管理</a>
        <a href="#cat-CSV上传" class="sidebar-link">CSV上传</a>
        <a href="#cat-发票管理" class="sidebar-link">发票管理</a>
        <a href="#cat-合作伙伴" class="sidebar-link">合作伙伴</a>
        <a href="#cat-账户管理" class="sidebar-link">账户管理</a>
        <a href="#cat-导航通知" class="sidebar-link">导航通知</a>
    </div>
    
    <footer>
        <p>大贺运输新系统 API 文档 | 72 APIs | 13 shared APIs</p>
        <p>Generated: 2026-02-10</p>
    </footer>

    <script>
    const categories = {
        "认证授权": {
            apis: [{"method": "POST", "path": "/auth/refresh", "summary": "刷新Token (共用)"}, {"method": "GET", "path": "/users/me", "summary": "获取当前用户信息 (共用)"}],
            b_apis: [{"method": "POST", "path": "/auth/callback", "summary": "AzureAD回调处理 (B)"}, {"method": "POST", "path": "/auth/logout", "summary": "登出 (B)"}],
            p_apis: [{"method": "POST", "path": "/auth/login", "summary": "合作伙伴登录 (P)"}]
        },
        "订单管理": {
            apis: [{"method": "GET", "path": "/orders/search", "summary": "搜索订单 (共用)"}, {"method": "GET", "path": "/orders/{orderId}", "summary": "获取订单详情 (共用)"}, {"method": "PUT", "path": "/orders/{orderId}", "summary": "更新订单 (共用)"}, {"method": "PUT", "path": "/orders/{orderId}/status", "summary": "更新订单状态 (共用)"}, {"method": "GET", "path": "/orders/{orderId}/documents", "summary": "获取文档列表 (共用)"}],
            b_apis: [{"method": "POST", "path": "/orders/{orderId}/cancel", "summary": "取消订单 (B)"}, {"method": "GET", "path": "/orders/{orderId}/history", "summary": "获取操作历史 (B)"}, {"method": "POST", "path": "/orders/{orderId}/documents", "summary": "上传文档 (B)"}],
            p_apis: [{"method": "POST", "path": "/orders/{orderId}/accept", "summary": "接受订单 (P)"}, {"method": "POST", "path": "/orders/{orderId}/decline", "summary": "拒绝订单 (P)"}, {"method": "POST", "path": "/orders/{orderId}/complete", "summary": "完成订单 (P)"}, {"method": "GET", "path": "/orders/{orderId}/messages", "summary": "获取消息 (P)"}, {"method": "POST", "path": "/orders/{orderId}/messages", "summary": "发送消息 (P)"}]
        },
        "实绩管理": {
            apis: [{"method": "GET", "path": "/completed-orders/{completedOrderId}", "summary": "获取实绩详情 (共用)"}],
            b_apis: [{"method": "GET", "path": "/completed-orders/search", "summary": "搜索实绩 (B)"}, {"method": "PUT", "path": "/completed-orders/{completedOrderId}", "summary": "更新实绩 (B)"}, {"method": "POST", "path": "/completed-orders/{completedOrderId}/confirm", "summary": "确认实绩 (B)"}, {"method": "POST", "path": "/completed-orders/{completedOrderId}/reject", "summary": "拒绝实绩 (B)"}, {"method": "GET", "path": "/completed-orders/{completedOrderId}/documents", "summary": "获取文档 (B)"}, {"method": "POST", "path": "/completed-orders/{completedOrderId}/documents", "summary": "上传文档 (B)"}, {"method": "DELETE", "path": "/completed-orders/{completedOrderId}/documents/{docId}", "summary": "删除文档 (B)"}, {"method": "GET", "path": "/completed-orders/{completedOrderId}/history", "summary": "获取历史 (B)"}],
            p_apis: [{"method": "GET", "path": "/partners/results", "summary": "获取业绩列表 (P)"}, {"method": "GET", "path": "/partners/results/{resultId}/daily-costs", "summary": "获取日別傭車費 (P)"}, {"method": "PUT", "path": "/partners/results/{resultId}/daily-costs/{costId}", "summary": "更新日別傭車費 (P)"}, {"method": "GET", "path": "/partners/results/{resultId}/instructions", "summary": "获取指示書 (P)"}, {"method": "POST", "path": "/partners/results/{resultId}/confirm", "summary": "确认业绩 (P)"}, {"method": "POST", "path": "/partners/results/{resultId}/inquiry", "summary": "确认请求 (P)"}, {"method": "GET", "path": "/partners/results/{resultId}/messages", "summary": "获取消息 (P)"}, {"method": "POST", "path": "/partners/results/{resultId}/messages", "summary": "发送消息 (P)"}, {"method": "GET", "path": "/partners/results/{resultId}/pdf", "summary": "下载PDF (P)"}]
        },
        "账单管理": {
            apis: [{"method": "GET", "path": "/billings/{billingId}", "summary": "获取账单详情 (共用)"}, {"method": "PUT", "path": "/billings/{billingId}", "summary": "更新账单 (共用)"}, {"method": "PUT", "path": "/billings/{billingId}/status", "summary": "更新账单状态 (共用)"}],
            b_apis: [{"method": "GET", "path": "/billings/search", "summary": "搜索账单 (B)"}, {"method": "POST", "path": "/billings/{billingId}/approve", "summary": "批准账单 (B)"}, {"method": "POST", "path": "/billings/{billingId}/reject", "summary": "拒绝账单 (B)"}, {"method": "GET", "path": "/billings/{billingId}/items", "summary": "获取账单项目 (B)"}, {"method": "GET", "path": "/billings/{billingId}/documents", "summary": "获取文档 (B)"}],
            p_apis: [{"method": "GET", "path": "/partners/billings/search", "summary": "搜索账单 (P)"}, {"method": "GET", "path": "/partners/billings/{billingId}", "summary": "获取账单详情 (P)"}, {"method": "GET", "path": "/partners/billings/{billingId}/download", "summary": "下载账单 (P)"}, {"method": "POST", "path": "/partners/billings/export", "summary": "导出账单 (P)"}]
        },
        "CSV上传": {
            apis: [{"method": "POST", "path": "/csv/upload", "summary": "上传CSV文件"}, {"method": "POST", "path": "/csv/upload/validate", "summary": "验证CSV数据"}, {"method": "GET", "path": "/csv/upload/{uploadId}/status", "summary": "获取上传状态"}, {"method": "GET", "path": "/csv/upload/{uploadId}/errors", "summary": "获取错误列表"}, {"method": "POST", "path": "/csv/upload/{uploadId}/confirm", "summary": "确认导入"}, {"method": "POST", "path": "/csv/upload/{uploadId}/cancel", "summary": "取消上传"}],
            b_apis: [],
            p_apis: []
        },
        "发票管理": {
            apis: [],
            b_apis: [],
            p_apis: [{"method": "GET", "path": "/partners/achievements/confirmed", "summary": "获取已确认业绩 (P)"}, {"method": "GET", "path": "/partners/bases", "summary": "获取基地列表 (P)"}, {"method": "POST", "path": "/partners/invoices/upload", "summary": "上传请求书PDF (P)"}, {"method": "GET", "path": "/partners/invoices", "summary": "获取上传文件列表 (P)"}, {"method": "GET", "path": "/partners/invoices/{invoiceId}/preview", "summary": "获取预览URL (P)"}, {"method": "DELETE", "path": "/partners/invoices/{invoiceId}", "summary": "删除上传文件 (P)"}, {"method": "POST", "path": "/partners/invoices/{invoiceId}/send", "summary": "发送请求书 (P)"}, {"method": "GET", "path": "/partners/invoices/{invoiceId}/download", "summary": "下载请求书 (P)"}, {"method": "GET", "path": "/partners/messages", "summary": "获取消息历史 (P)"}, {"method": "POST", "path": "/partners/messages", "summary": "发送消息 (P)"}, {"method": "GET", "path": "/partners/messages/attachments/{attachmentId}/download", "summary": "下载附件 (P)"}]
        },
        "合作伙伴": {
            apis: [{"method": "GET", "path": "/partners/{partnerId}", "summary": "获取合作伙伴详情 (共用)"}],
            b_apis: [{"method": "GET", "path": "/partners/search", "summary": "搜索合作伙伴 (B)"}, {"method": "PUT", "path": "/partners/{partnerId}", "summary": "更新合作伙伴 (B)"}, {"method": "GET", "path": "/partners/{partnerId}/users", "summary": "获取公司用户列表 (B)"}, {"method": "GET", "path": "/partners/{partnerId}/users/{userId}", "summary": "获取用户详情 (B)"}, {"method": "PUT", "path": "/partners/{partnerId}/users/{userId}", "summary": "更新用户信息 (B)"}, {"method": "POST", "path": "/partners/{partnerId}/users/{userId}/reset-password", "summary": "重置密码 (B)"}],
            p_apis: []
        },
        "账户管理": {
            apis: [{"method": "GET", "path": "/accounts/{accountId}", "summary": "获取账户详情 (共用)"}],
            b_apis: [{"method": "GET", "path": "/accounts/search", "summary": "搜索基础账户 (B)"}, {"method": "PUT", "path": "/accounts/{accountId}", "summary": "更新账户 (B)"}, {"method": "GET", "path": "/accounts/{accountId}/permissions", "summary": "获取权限列表 (B)"}, {"method": "PUT", "path": "/accounts/{accountId}/roles", "summary": "更新角色 (B)"}, {"method": "POST", "path": "/accounts/{accountId}/activate", "summary": "激活账户 (B)"}, {"method": "POST", "path": "/accounts/{accountId}/deactivate", "summary": "停用账户 (B)"}],
            p_apis: []
        },
        "导航通知": {
            apis: [{"method": "GET", "path": "/bases", "summary": "获取基地列表"}, {"method": "GET", "path": "/actions/history", "summary": "获取操作历史"}, {"method": "GET", "path": "/navigation/menu", "summary": "获取导航菜单"}, {"method": "GET", "path": "/notifications", "summary": "获取通知列表"}],
            b_apis: [],
            p_apis: []
        }
    };

    function renderAPIs() {
        const container = document.getElementById('apiContainer');
        container.innerHTML = '';
        const searchKeyword = document.getElementById('searchInput').value.toLowerCase();
        
        Object.keys(categories).forEach(catName => {
            const cat = categories[catName];
            const allApis = [
                ...cat.apis.map(a => ({...a, type: 'shared'})),
                ...cat.b_apis.map(a => ({...a, type: 'b'})),
                ...cat.p_apis.map(a => ({...a, type: 'p'}))
            ];
            
            const visibleApis = allApis.filter(api => {
                const matchSearch = !searchKeyword || 
                                   api.path.toLowerCase().includes(searchKeyword) ||
                                   api.summary.toLowerCase().includes(searchKeyword) ||
                                   api.method.toLowerCase().includes(searchKeyword);
                return matchSearch;
            });
            
            if (visibleApis.length > 0) {
                const sectionId = 'cat-' + catName;
                let html = `<div id="${sectionId}" class="category">`;
                html += `<div class="category-header"><h2>${catName}</h2></div>`;
                
                if (cat.apis.length > 0) {
                    const sharedVisible = visibleApis.filter(a => a.type === 'shared');
                    if (sharedVisible.length > 0) {
                        html += `<div class="section-header shared">共用 API</div>`;
                        html += `<div class="api-list">`;
                        sharedVisible.forEach(api => {
                            html += renderApiItem(api);
                        });
                        html += `</div>`;
                    }
                }
                
                if (cat.b_apis.length > 0) {
                    const bVisible = visibleApis.filter(a => a.type === 'b');
                    if (bVisible.length > 0) {
                        html += `<div class="section-header b">B系列 API</div>`;
                        html += `<div class="api-list">`;
                        bVisible.forEach(api => {
                            html += renderApiItem(api);
                        });
                        html += `</div>`;
                    }
                }
                
                if (cat.p_apis.length > 0) {
                    const pVisible = visibleApis.filter(a => a.type === 'p');
                    if (pVisible.length > 0) {
                        html += `<div class="section-header p">P系列 API</div>`;
                        html += `<div class="api-list">`;
                        pVisible.forEach(api => {
                            html += renderApiItem(api);
                        });
                        html += `</div>`;
                    }
                }
                
                html += `</div>`;
                container.innerHTML += html;
            }
        });
        
        if (!container.innerHTML) {
            container.innerHTML = '<div style="text-align:center;padding:60px;color:#888;"><h3>未找到相关API</h3></div>';
        }
    }
    
    function renderApiItem(api) {
        const tagLabel = api.type === 'shared' ? '共用' : api.type === 'b' ? 'B系列' : 'P系列';
        return `<div class="api-item">
            <span class="method ${api.method}">${api.method}</span>
            <div class="api-info">
                <div class="api-path">${api.path}</div>
                <div class="api-desc">${api.summary}</div>
                <span class="tag ${api.type}">${tagLabel}</span>
            </div>
        </div>`;
    }
    
    document.getElementById('searchInput').addEventListener('input', renderAPIs);
    
    document.querySelectorAll('.filter-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            const method = tab.dataset.filter;
            const searchInput = document.getElementById('searchInput');
            if (method === 'all') {
                searchInput.dataset.filter = '';
            } else {
                searchInput.dataset.filter = method;
            }
            renderAPIs();
        });
    });
    
    document.querySelectorAll('.sidebar-link').forEach(link => {
        link.addEventListener('click', e => {
            e.preventDefault();
            const target = document.getElementById(link.getAttribute('href').replace('#', ''));
            if (target) target.scrollIntoView({ behavior: 'smooth' });
        });
    });
    
    renderAPIs();
    </script>
</body>
</html>
